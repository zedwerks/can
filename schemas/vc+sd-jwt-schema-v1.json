{
  "$id": "https://zedwerks.github.io/can/schemas/vc+sd-jwt-schema-v1.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",

  "type": "object",
  "allOf": [
    {
      "$ref": "https://zedwerks.github.io/can/schemas/sd-jwt-schema-v1.schema.json"
    },
    {
      "type": "object",
      "properties": {
        "vct": {
          "description": "Optional: For Verifiable Credential Type Profile",
          "type": "string",
          "format": "uri"
        },
        "cnf": {
          "type": "object",
          "description": "Confirmation Claim for Key-Binding Thumbprint",
          "oneOf": [
            {
              "description": "Holder binding via full public JWK",
              "properties": {
                "jwk": {
                  "type": "object",
                  "description": "Holder public key in JWK Format"
                }
              },
              "required": [
                "jwk"
              ],
              "additionalProperties": false
            },
            {
              "description": "Holder binding via JWK Thumbprint",
              "properties": {
                "jkt": {
                  "type": "string",
                  "description": "Key-Binding JWK Thumbprint"
                }
              },
              "required": [
                "jkt"
              ],
              "additionalProperties": false
            }
          ]
        }
      }
    }
  ],
  "required": [
    "iss",
    "iat",
    "vct"
  ]
}
